# 导出功能使用指南

## 📊 导出功能概述

本系统支持多种格式的数据导出，方便用户进行数据分析和备份。

## 🚀 支持的导出格式

### 1. Excel 导出 (.xlsx)
- **功能**：导出为Excel格式，包含多个工作表
- **特点**：
  - 包含问卷数据主表
  - 包含统计信息表
  - 自动调整列宽
  - 冻结窗格（前两列）
  - 支持中文显示

### 2. CSV 导出 (.csv)
- **功能**：导出为CSV格式，便于其他系统导入
- **特点**：
  - UTF-8编码，支持中文
  - 逗号分隔
  - 适合Excel、Google Sheets等工具打开

### 3. JSON 导出 (.json)
- **功能**：导出为JSON格式，用于数据备份
- **特点**：
  - 包含完整的元数据
  - 包含问题配置信息
  - 便于程序处理

## 📋 使用方法

### 在界面中使用
1. 点击右上角的"导出数据"按钮
2. 选择需要的导出格式：
   - Excel：适合数据分析和展示
   - CSV：适合数据交换
   - JSON：适合数据备份

### 导出文件命名规则
```
{文件名}_{日期}.{扩展名}
例如：问卷数据_2024-01-15.xlsx
```

## 🔧 技术实现

### 依赖包
```json
{
  "xlsx": "^0.18.5",        // Excel处理
  "file-saver": "^2.0.5"    // 文件下载
}
```

### 核心功能
- **数据处理**：自动处理数组、对象等复杂数据类型
- **列宽优化**：根据内容长度自动调整列宽
- **编码支持**：完全支持中文字符
- **错误处理**：完善的错误提示和异常处理

## 📁 导出文件结构

### Excel文件结构
```
问卷数据.xlsx
├── 问卷数据 (主表)
│   ├── 序号
│   ├── 提交时间
│   └── 各问题列...
└── 统计信息 (统计表)
    ├── 总记录数
    ├── 导出时间
    └── 问题数量
```

### CSV文件结构
```
序号,提交时间,性别,年龄段,婚恋状况,...
1,2024-01-15 10:30:00,男,26-35岁,未婚，无恋爱对象,...
```

### JSON文件结构
```json
{
  "exportTime": "2024-01-15T10:30:00.000Z",
  "totalRecords": 10,
  "questions": [...],
  "data": [...]
}
```

## ⚠️ 注意事项

1. **数据量限制**：建议单次导出不超过10000条记录
2. **浏览器兼容性**：需要支持ES6的现代浏览器
3. **文件大小**：Excel文件可能较大，请确保有足够的存储空间
4. **网络环境**：导出过程在客户端完成，不需要网络连接

## 🐛 常见问题

### Q: 导出失败怎么办？
A: 检查浏览器控制台错误信息，确保数据格式正确。

### Q: 中文显示乱码？
A: 确保使用UTF-8编码，Excel导出已自动处理编码问题。

### Q: 文件太大无法打开？
A: 尝试导出CSV格式，或分批导出数据。

### Q: 如何自定义导出内容？
A: 修改 `src/utils/excelExport.ts` 文件中的数据处理逻辑。

## 🔄 更新日志

- v1.0.0: 基础导出功能
- v1.1.0: 添加统计信息表
- v1.2.0: 优化列宽和冻结窗格
- v1.3.0: 添加JSON导出功能
